# E2.1 - Systems of linear equations - Gauss elimination

## Question 1 - Gauss elimination (1/3)

### Solution

```
0, -2.25, 1
```

### Explications

Pour résoudre cette question, il suffit d'appliquer l'[élimination de Gauss-Jordan](https://fr.wikipedia.org/wiki/%C3%89limination_de_Gauss-Jordan) telle que vue l'année passée en algèbre (LINFO1112).

On commence par noter la matrice $A$ et le vecteur $b$ dans une seule matrice afin de rendre la manipulation plus facile :

$$
\left(
\begin{array}{ccc|c}
8 & -4 & 2 & 11 \\
-4 & 8 & 2 & -16 \\
2 & -4 & 8 & 17 \\
\end{array}
\right)
$$

On applique ensuite des transformations sur les lignes pour obtenir une matrice triangulaire supérieure dont les pivots valent 1. Ce processus porte le nom de substitution vers l'avant (*forward substitution* en anglais).

$$
\left(
\begin{array}{ccc|c}
8 & -4 & 2 & 11 \\
-4 & 8 & 2 & -16 \\
2 & -4 & 8 & 17 \\
\end{array}
\right)

\xrightarrow{L1 = L1 \div 8}

\left(
\begin{array}{ccc|c}
1 & \frac{-1}{2} & \frac{1}{4} & \frac{11}{8} \\
-4 & 8 & 2 & -16 \\
2 & -4 & 8 & 17 \\
\end{array}
\right)

\xrightarrow{L2 = L2 + 4 * L1}

\left(
\begin{array}{ccc|c}
1 & \frac{-1}{2} & \frac{1}{4} & \frac{11}{8} \\
0 & 6 & 3 & \frac{-21}{2} \\
2 & -4 & 8 & 17 \\
\end{array}
\right)

\xrightarrow{L3 = L3 - 2 * L1}

\left(
\begin{array}{ccc|c}
1 & \frac{-1}{2} & \frac{1}{4} & \frac{11}{8} \\
0 & 6 & 3 & \frac{-21}{2} \\
0 & -3 & \frac{15}{2} & \frac{57}{4} \\
\end{array}
\right)

\xrightarrow{L2 = L2 \div 6}

\left(
\begin{array}{ccc|c}
1 & \frac{-1}{2} & \frac{1}{4} & \frac{11}{8} \\
0 & 1 & \frac{1}{2} & \frac{-7}{4} \\
0 & -3 & \frac{15}{2} & \frac{57}{4} \\
\end{array}
\right)

\xrightarrow{L3 = L3 + 3 * L2}

\left(
\begin{array}{ccc|c}
1 & \frac{-1}{2} & \frac{1}{4} & \frac{11}{8} \\
0 & 1 & \frac{1}{2} & \frac{-7}{4} \\
0 & 0 & 9 & 9 \\
\end{array}
\right)

\xrightarrow{L3 = L3 \div 9}

\left(
\begin{array}{ccc|c}
1 & \frac{-1}{2} & \frac{1}{4} & \frac{11}{8} \\
0 & 1 & \frac{1}{2} & \frac{-7}{4} \\
0 & 0 & 1 & 1 \\
\end{array}
\right)
$$

On transforme ensuite la matrice en un système de 3 équations/3 inconnues que l'on résout. Ce processus porte le nom de substitution vers l'arrière (*backward substitution* en anglais).

$$
\begin{align*}
&\leftrightarrow
\begin{dcases}
x_1 - \frac{1}{2}x_2 + \frac{1}{4}x_3 = \frac{11}{8} \\
x_2 + \frac{1}{2}x_3 = \frac{-7}{4} \\
x_3 = 1
\end{dcases}
&&\leftrightarrow
\begin{dcases}
x_1 - \frac{1}{2}x_2 + \frac{1}{4} = \frac{11}{8} \\
x_2 + \frac{1}{2} = \frac{-7}{4} \\
x_3 = 1
\end{dcases} \\
&\leftrightarrow
\begin{dcases}
x_1 - \frac{1}{2}x_2 + \frac{1}{4} = \frac{11}{8} \\
x_2 = \frac{-9}{4} \\
x_3 = 1
\end{dcases}
&&\leftrightarrow
\begin{dcases}
x_1 + \frac{9}{8} + \frac{1}{4} = \frac{11}{8} \\
x_2 = \frac{-9}{4} \\
x_3 = 1
\end{dcases} \\
&\leftrightarrow
\begin{dcases}
x_1 + \frac{11}{8} = \frac{11}{8} \\
x_2 = \frac{-9}{4} \\
x_3 = 1
\end{dcases}
&&\leftrightarrow
\begin{dcases}
x_1 = 0 \\
x_2 = \frac{-9}{4} \\
x_3 = 1
\end{dcases}
\end{align*}
$$

On obtient que $x_1 = 0$, $x_2 = \frac{-9}{4} = -2.25$ et $x_3 = 1$.

## Question 2 - Gauss elimination (2/3)

### Solution

```py:line-numbers
for i in range(n):
    temp = a[i][i]
    a[i] /= temp # Makes pivot 1
    b[i] /= temp

    for j in range(i + 1, n):
        temp = a[j][i]
        a[j] -= temp * a[i]
        b[j] -= temp * b[i]
```

### Explications

## Question 3 - Gauss elimination (3/3)

### Solution

```py:line-numbers
for i in reversed(range(0, n - 1)):
    result = 0

    for j in range(i + 1, n):
        result += a[i][j] * b[j]
        a[i][j] = 0

    b[i] -= result
```

### Explications

## Question 4 - Multiple vectors

### Solution

```py:line-numbers
def gauss_elimin_mult(a, b):
    n = len(b)
    m = np.c_[a, b]

    for i in range(n):
        m[i] /= m[i][i] # Makes pivot 1

        for j in range(n):
            if i == j: continue

            m[j] -= m[j][i] * m[i]

    return m[:, n:]
```

### Explications

## Question 5 - Matrix inversion

### Solution

```py:line-numbers
a_inv = gauss_elimin_mult(a, np.identity(3))
a_ctrl = np.matmul(a, a_inv)
```

### Explications

## Question 6 - Partial pivoting

### Solution

```py:line-numbers
def gauss_elimin_pp(a, b):
    n = len(b)
    m = np.c_[a, b]

    for i in range(n):
        pivot(m, i, n) # Swaps rows to make pivot non-null
        m[i] /= m[i][i] # Makes pivot 1

        for j in range(n):
            if i == j: continue

            m[j] -= m[j][i] * m[i]

    return np.transpose(m[:, n:])[0]

def pivot(m, column, length):
    maxPivot = max(m[:, column].min(), m[:, column].max(), key=abs) # Find the max absolute value in column

    for j in range(length):
        if m[j][column] != maxPivot: continue

        m[[column, j]] = m[[j, column]]
        break # Pivot was found, no need to keep swapping
```

### Explications